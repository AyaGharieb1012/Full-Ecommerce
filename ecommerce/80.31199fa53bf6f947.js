"use strict";(self.webpackChunkecommerce=self.webpackChunkecommerce||[]).push([[80],{5080:(v,u,r)=>{r.r(u),r.d(u,{WishlistComponent:()=>D});var _=r(6814),p=r(1120),m=r(8129),t=r(4769),a=r(9196),n=r(2425),l=r(9779);function i(o,g){if(1&o){const e=t.EpF();t.TgZ(0,"i",19),t.NdJ("click",function(){t.CHM(e);const c=t.oxw().$implicit,h=t.oxw(2);return t.KtG(h.addToMyWishlist(c._id))}),t.qZA()}}function d(o,g){if(1&o){const e=t.EpF();t.TgZ(0,"i",20),t.NdJ("click",function(){t.CHM(e);const c=t.oxw().$implicit,h=t.oxw(2);return t.KtG(h.removeWishlist(c._id))}),t.qZA()}}function f(o,g){if(1&o&&t._UZ(0,"i",21),2&o){const e=g.$implicit,s=t.oxw().$implicit;t.ekj("rating-color",s.ratingsAverage>=e)}}const C=function(o){return["/details",o]},E=function(){return[1,2,3,4,5]};function x(o,g){if(1&o){const e=t.EpF();t.TgZ(0,"div",5)(1,"div",6),t.YNc(2,i,1,0,"i",7),t.YNc(3,d,1,0,"i",8),t.TgZ(4,"header",9),t._UZ(5,"img",10),t.TgZ(6,"h3",11),t._uU(7),t.ALo(8,"cuttext"),t.qZA(),t.TgZ(9,"h4",12),t._uU(10),t.qZA(),t.TgZ(11,"div",13)(12,"span"),t._uU(13),t.ALo(14,"currency"),t.qZA(),t.TgZ(15,"p",14),t.YNc(16,f,1,2,"i",15),t.TgZ(17,"span",16),t._uU(18),t.qZA()()()(),t.TgZ(19,"footer")(20,"button",17,18),t.NdJ("click",function(){const h=t.CHM(e).$implicit,O=t.MAs(21),U=t.oxw(2);return t.KtG(U.addProduct(h._id,O))}),t._uU(22," +Add To Cart "),t.qZA()()()()}if(2&o){const e=g.$implicit,s=t.oxw(2);t.xp6(2),t.Q6J("ngIf",!s.wishlistData.includes(e._id)),t.xp6(1),t.Q6J("ngIf",s.wishlistData.includes(e._id)),t.xp6(1),t.Q6J("routerLink",t.VKq(17,C,e._id)),t.xp6(1),t.Q6J("src",e.imageCover,t.LSH)("alt",e.title)("title",e.title),t.xp6(2),t.Oqu(t.xi3(8,11,e.title,3)),t.xp6(3),t.Oqu(e.category.name),t.xp6(3),t.Oqu(t.xi3(14,14,e.price,"e\xa3")),t.xp6(3),t.Q6J("ngForOf",t.DdM(19,E)),t.xp6(2),t.hij(" ",e.ratingsAverage,"")}}function T(o,g){if(1&o&&(t.TgZ(0,"section",1)(1,"h2",2),t._uU(2,"My WishList"),t.qZA(),t.TgZ(3,"div",3),t.YNc(4,x,23,20,"div",4),t.qZA()()),2&o){const e=t.oxw();t.xp6(4),t.Q6J("ngForOf",e.Products)}}let D=(()=>{class o{constructor(e,s,c,h){this._WishlistService=e,this._ToastrService=s,this._CartsService=c,this._Renderer2=h,this.Products=[],this.wishlistData=[]}ngOnInit(){this._WishlistService.getWishlist().subscribe({next:e=>{this.Products=e.data;const s=e.data.map(c=>c._id);this.wishlistData=s}})}addProduct(e,s){this._Renderer2.setAttribute(s,"disabled","true"),this._CartsService.addToCart(e).subscribe({next:c=>{console.log(c),console.log(c.message),this._ToastrService.success(c.message,"",{closeButton:!0,progressBar:!0,progressAnimation:"increasing",positionClass:"toast-top-right",timeOut:1e3}),this._Renderer2.removeAttribute(s,"disabled"),this._CartsService.cartNumber.next(c.numOfCartItems)},error:c=>{this._Renderer2.removeAttribute(s,"disabled")}})}addToMyWishlist(e){this._WishlistService.addToWishlist(e).subscribe({next:s=>{console.log(s),this._ToastrService.success(s.message),this.wishlistData=s.data}})}removeWishlist(e){this._WishlistService.removeItemFromWishlist(e).subscribe({next:s=>{console.log(s),this._ToastrService.success(s.message),this.wishlistData=s.data,this._WishlistService.wishNum.next(s.data.length);const c=this.Products.filter(h=>this.wishlistData.includes(h._id));console.log(c),this.Products=c}})}static#t=this.\u0275fac=function(s){return new(s||o)(t.Y36(a.M),t.Y36(n._W),t.Y36(l._),t.Y36(t.Qsj))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-wishlist"]],standalone:!0,features:[t.jDz],decls:1,vars:1,consts:[["class","py-4",4,"ngIf"],[1,"py-4"],[1,"text-center","text-main","p-3"],[1,"row","g-4"],["class","col-sm-6 col-md-4 col-lg-3 col-xl-2",4,"ngFor","ngForOf"],[1,"col-sm-6","col-md-4","col-lg-3","col-xl-2"],[1,"product","h-100"],["class","fa-regular fa-heart  heart",3,"click",4,"ngIf"],["class","fa-solid fa-heart heart",3,"click",4,"ngIf"],["role","button",3,"routerLink"],[1,"w-100",3,"src","alt","title"],[1,"small"],[1,"h6","text-main"],[1,"d-flex","align-items-center","justify-content-between","small"],[1,"mb-0"],["class","fas fa-star ",3,"rating-color",4,"ngFor","ngForOf"],[1,"text-muted"],[1,"btn-main","py-2","w-100",3,"click"],["btnAdd",""],[1,"fa-regular","fa-heart","heart",3,"click"],[1,"fa-solid","fa-heart","heart",3,"click"],[1,"fas","fa-star"]],template:function(s,c){1&s&&t.YNc(0,T,5,1,"section",0),2&s&&t.Q6J("ngIf",c.Products.length>0)},dependencies:[_.ez,_.sg,_.O5,_.H9,p.rH,m.r]})}return o})()},9779:(v,u,r)=>{r.d(u,{_:()=>a});var _=r(8784),p=r(5619),m=r(4769),t=r(9862);let a=(()=>{class n{constructor(i){this._HttpClient=i,this.baseUrl="https://ecommerce.routemisr.com/api/v1/",this.cartNumber=new p.X(0)}addToCart(i){return this._HttpClient.post(this.baseUrl+"cart",{productId:i})}getUserCart(){return this._HttpClient.get(this.baseUrl+"cart")}removeUserCart(i){return this._HttpClient.delete(this.baseUrl+`cart/${i}`)}updateCartCount(i,d){return this._HttpClient.put(this.baseUrl+`cart/${i}`,{count:d})}clearCart(){return this._HttpClient.delete(this.baseUrl+"cart/")}decodeUser(){const i=localStorage.getItem("etoken");if(null!==i){const d=(0,_.o)(i);this.userInfo=d}}checkOut(i,d){return this._HttpClient.post(this.baseUrl+`orders/checkout-session/${i}?url=http://localhost:4200`,{shippingAddress:d})}getUserOrder(i){return this._HttpClient.get(this.baseUrl+`orders/user/${i}`)}static#t=this.\u0275fac=function(d){return new(d||n)(m.LFG(t.eN))};static#e=this.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})()},9196:(v,u,r)=>{r.d(u,{M:()=>t});var _=r(5619),p=r(4769),m=r(9862);let t=(()=>{class a{constructor(l){this._HttpClient=l,this.baseUrl="https://ecommerce.routemisr.com/api/v1/",this.wishNum=new _.X(0)}addToWishlist(l){return this._HttpClient.post(this.baseUrl+"wishlist",{productId:l})}getWishlist(){return this._HttpClient.get(this.baseUrl+"wishlist")}removeItemFromWishlist(l){return this._HttpClient.delete(this.baseUrl+`wishlist/${l}`)}static#t=this.\u0275fac=function(i){return new(i||a)(p.LFG(m.eN))};static#e=this.\u0275prov=p.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()},8784:(v,u,r)=>{r.d(u,{o:()=>t});class _ extends Error{}function t(a,n){if("string"!=typeof a)throw new _("Invalid token specified: must be a string");n||(n={});const l=!0===n.header?0:1,i=a.split(".")[l];if("string"!=typeof i)throw new _(`Invalid token specified: missing part #${l+1}`);let d;try{d=function m(a){let n=a.replace(/-/g,"+").replace(/_/g,"/");switch(n.length%4){case 0:break;case 2:n+="==";break;case 3:n+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function p(a){return decodeURIComponent(atob(a).replace(/(.)/g,(n,l)=>{let i=l.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i}))}(n)}catch{return atob(n)}}(i)}catch(f){throw new _(`Invalid token specified: invalid base64 for part #${l+1} (${f.message})`)}try{return JSON.parse(d)}catch(f){throw new _(`Invalid token specified: invalid json for part #${l+1} (${f.message})`)}}_.prototype.name="InvalidTokenError"}}]);